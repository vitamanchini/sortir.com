{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/home-page.css') }}">
{% endblock %}

{% block title %}Accueil{% endblock %}
{% block main %}

    <section id="user-date-field">
        <div>
            <p>Date du jour: {{ "now"|date("d-m-Y") }} </p>
            <p>Participant: {{ user.name }} {{ user.secondName }}</p>
        </div>
    </section>
    <div>
        <div id="filtering">
            <h2>Filtrer les sortis</h2>
            <img id="filterslogo" src="{{ asset('assets/filterslogo.png') }}" alt="filters">
        </div>

        {{ form_start(filters) }}
        <div id="filter-section" class="is-hidden">
            <div id="filters-first-col">
                {{ form_row(filters.site) }}
                {{ form_row(filters.search) }}
                <div id="dates-filter">
                    {{ form_row(filters.dateStart) }}
                    {{ form_row(filters.dateEnd) }}
                </div>

            </div>
            <div id="filters-second-col">

                {{ form_row(filters.choiseMeOrganisator) }}
                {{ form_row(filters.choiseMeInscribed) }}
                {{ form_row(filters.choiseMeNotInscribed) }}
                {{ form_row(filters.finishedEvents) }}
            </div>
            <div id="filters-third-col">
                <button id="search">Rechercher</button>
            </div>
        </div>

        {{ form_end(filters) }}


    </div>


    <table id="sorties-table">
        <tr>
            <th>Nom de la sortie</th>
            <th>Date de la sortie</th>
            <th id="invis">Clôture</th>
            <th id="invis">Inscrits/places</th>
            <th id="invis">Etat</th>
            <th id="invis">Inscrit</th>
            <th id="invis">Organisateur</th>
            <th>Actions</th>
        </tr>
        {% for sortie in sorties %}
            <tr>
                <td>{{ sortie.name }}</td>
                <td>{{ sortie.dateHourStart | date('H-i / d-m-Y') }}</td>
                <td id="invis">{{ sortie.dateLimitInscription | date('d-m-Y') }}</td>
                <td id="invis">{{ sortie.participants | length }} / {{ sortie.maxInscriptions }}</td>
                <td id="invis">{{ sortie.status.label }}</td>

                {% if sortie.participants.user.id is defined %}
                    <td id="invis">Inscribed</td>
                {% else %}
                    <td id="invis">Not inscribed</td>
                {% endif %}
                <td id="invis">{{ sortie.organizer.name }} {{ sortie.organizer.secondName }} </td>

                <td>Actions</td>
            </tr>
        {% endfor %}
    </table>
    <a href="{{ path('main_home') }}">
        <button id="new-sortie">Créer une sortie</button>
    </a>

{% endblock %}
    {% block scripts %}
        <script src="{{ asset('scripts/home-page.js') }}"></script>
    {% endblock %}